<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LocalGen AI</title>
    <link rel="stylesheet" href="/src/style.css" />
  </head>
  <body>
    <div id="app-container">
      <!-- Loading Overlay -->
      <div
        id="loading-overlay"
        style="
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.8);
          z-index: 1000;
          justify-content: center;
          align-items: center;
          color: white;
          flex-direction: column;
        "
      >
        <div style="font-size: 24px; margin-bottom: 10px">
          Switching Model...
        </div>
        <div>This may take a few seconds.</div>
      </div>

      <!-- New main container for sidebar layout -->
      <div id="history-sidebar">
        <div class="history-header">
          <h2>History</h2>
        </div>
        <span class="divider"></span>
        <div class="history-header" style="padding-top: 0">
          <button id="generete-new-button" title="Generate new">New</button>
          <button id="delete-history-button" title="Delete all history">
            Clear History
          </button>
          <!-- Delete all button -->
        </div>
        <div id="history-list"></div>
        <!-- Changed from history-grid to history-list -->
      </div>
      <div id="app">
        <h1>LocalGen AI Image Generator</h1>
        <div id="image-display">
          <p>Generated image will appear here.</p>
        </div>
        <div
          id="progress-container"
          style="
            display: none;
            width: 100%;
            margin-top: 10px;
            background-color: #333;
            border-radius: 4px;
            overflow: hidden;
          "
        >
          <div
            id="progress-bar"
            style="
              width: 0%;
              height: 20px;
              background-color: #4caf50;
              transition: width 0.1s ease;
            "
          ></div>
          <div
            id="progress-text"
            style="
              text-align: center;
              color: #fff;
              font-size: 12px;
              margin-top: -18px;
              position: relative;
            "
          >
            0%
          </div>
        </div>
        <div class="controls-container">
          <div
            id="inital-setting"
            style="display: flex; align-items: center; justify-content: center"
          >
            <!-- Model Selector -->
            <div
              style="
                padding: 0 10px 15px 10px;
                border-bottom: 1px solid #333;
                margin-bottom: 10px;
              "
            >
              <label
                for="model-selector"
                style="
                  display: block;
                  margin-bottom: 5px;
                  font-size: 14px;
                  color: #ccc;
                "
                >Model:</label
              >
              <select
                id="model-selector"
                style="
                  width: 100%;
                  padding: 8px;
                  background: #222;
                  color: white;
                  border: 1px solid #444;
                  border-radius: 4px;
                "
              >
                <option value="Default">Default (v1-5)</option>
              </select>
            </div>
            <!-- LoRA Selector -->
            <div
              style="
                padding: 0 10px 15px 10px;
                border-bottom: 1px solid #333;
                margin-bottom: 10px;
              "
            >
              <label
                for="lora-selector"
                style="
                  display: block;
                  margin-bottom: 5px;
                  font-size: 14px;
                  color: #ccc;
                "
                >LoRA:</label
              >
              <select
                id="lora-selector"
                style="
                  width: 100%;
                  padding: 8px;
                  background: #222;
                  color: white;
                  border: 1px solid #444;
                  border-radius: 4px;
                "
              >
                <option value="None">None</option>
              </select>
            </div>
            <!-- Scheduler Selector -->
            <div
              style="
                padding: 0 10px 15px 10px;
                border-bottom: 1px solid #333;
                margin-bottom: 10px;
              "
            >
              <label
                for="scheduler-selector"
                style="font-size: 14px; margin-bottom: 5px"
                >Scheduler:</label
              >
              <select
                id="scheduler-selector"
                style="
                  width: 100%;
                  padding: 8px;
                  background: #222;
                  color: white;
                  border: 1px solid #444;
                  border-radius: 4px;
                  box-sizing: border-box;
                "
              >
                <option value="Euler a">Euler a</option>
                <option value="Euler">Euler</option>
                <option value="DPM++ 2M Karras">DPM++ 2M Karras</option>
                <option value="DDIM">DDIM</option>
                <option value="UniPC">UniPC</option>
              </select>
            </div>
          </div>
          <textarea
            id="prompt-input"
            placeholder="Enter your prompt here..."
            rows="4"
          ></textarea>
          <div class="aspect-ratio-inputs">
            <input
              type="number"
              id="width-input"
              placeholder="Width (e.g., 512)"
              value="512"
            />
            <input
              type="number"
              id="height-input"
              placeholder="Height (e.g., 512)"
              value="512"
            />
          </div>
          <div class="button-container">
            <button id="generate-button" class="icon-button">Generate ➤</button>
            <button
              id="cancel-button"
              class="icon-button"
              style="display: none; background-color: #d32f2f"
            >
              Cancel
            </button>
            <button
              id="download-button"
              class="icon-button"
              style="display: none"
            >
              ⬇
            </button>
          </div>
        </div>
        <div class="file-input-container">
          <label for="init-image">Initial Image (Optional)</label>
          <input type="file" id="init-image" accept="image/*" />
          <button id="clear-image-button" style="display: none">Clear</button>
          
          <div style="display: flex; align-items: center; margin-left: 10px; gap: 5px;">
            <input type="checkbox" id="use-face-swap" name="use-face-swap" style="width: auto;">
            <label for="use-face-swap" title="Use the uploaded image as a face source instead of composition reference" style="margin-bottom: 0; font-size: 14px; cursor: pointer;">Use as Face Reference (Swap)</label>
          </div>
        </div>
        <details style="margin-bottom: 15px; color: #bbb; width: 100%">
          <summary
            style="cursor: pointer; margin-bottom: 10px; user-select: none"
          >
            Advanced Settings
          </summary>
          <div
            style="
              display: flex;
              flex-direction: column;
              gap: 10px;
              padding-left: 10px;
              border-left: 2px solid #444;
            "
          >
            <!-- Negative Prompt -->
            <div style="display: flex; flex-direction: column">
              <label
                for="negative-prompt"
                style="font-size: 14px; margin-bottom: 5px"
                >Negative Prompt:</label
              >
              <textarea
                id="negative-prompt"
                placeholder="low quality, ugly, blurry..."
                rows="2"
                style="
                  width: 100%;
                  padding: 8px;
                  background: #3a3a3a;
                  border: 1px solid #555;
                  color: #f0f0f0;
                  border-radius: 4px;
                  resize: vertical;
                  box-sizing: border-box;
                "
              >
bad proportions, low resolution, bad, ugly, bad hands, bad teeth, terrible, painting, 3d, render, comic, anime, manga, unrealistic, flat,  watermark, signature, worst quality, low quality</textarea
              >
            </div>
            <!-- Guidance Scale -->
            <div style="display: flex; align-items: center; gap: 10px">
              <label
                for="guidance-scale"
                style="font-size: 14px; min-width: 120px"
                >Guidance Scale:</label
              >
              <input
                type="range"
                id="guidance-scale"
                min="1"
                max="20"
                step="0.5"
                value="7.5"
                style="flex-grow: 1"
              />
              <span
                id="guidance-scale-value"
                style="width: 30px; text-align: right"
                >7.5</span
              >
            </div>
            <!-- Inference Steps -->
            <div style="display: flex; align-items: center; gap: 10px">
              <label
                for="inference-steps"
                style="font-size: 14px; min-width: 120px"
                >Inference Steps:</label
              >
              <input
                type="range"
                id="inference-steps"
                min="10"
                max="100"
                step="1"
                value="30"
                style="flex-grow: 1"
              />
              <span
                id="inference-steps-value"
                style="width: 30px; text-align: right"
                >30</span
              >
            </div>
          </div>
        </details>
      </div>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
